# ğŸ“Š Excel AI Query API

This project allows you to perform natural language queries on Excel files (even across multiple sheets and files) using OpenAIâ€™s GPT models and LangChain with FAISS for semantic search.

It exposes a FastAPI backend that you can run locally and query with plain English to retrieve structured data.

---

## ğŸš€ Features

- Upload Excel files with multiple sheets
- Semantic/NLP querying via OpenAI (GPT-4o)
- Uses FAISS vector store for document indexing
- Smart AI-based field mapping
- Embedding & mapping cache to reduce API calls
- Throttled embeddings to respect OpenAI rate limits

---

## ğŸ“ Project Structure

```
â”œâ”€â”€ app.py                # Main FastAPI app
â”œâ”€â”€ requirements.txt      # All dependencies
â”œâ”€â”€ vectorstore/          # FAISS vector DB (generated automatically)
â””â”€â”€ README.md             # You're reading it!
```

---

## ğŸ“¦ Requirements

- Python 3.9+
- OpenAI API Key

Install dependencies:

```bash
python3 -m pip install --break-system-packages -r requirements.txt

after successfully done with above install certify using below command

python3 -m pip install certifi --break-system-packages

```

---

## ğŸ—ƒ Git LFS Setup (for large files)

GitHub restricts files >100MB from being pushed through regular Git. To handle large files (like FAISS index files), you must configure Git LFS (Large File Storage).

### ğŸ”§ Install Git LFS

#### macOS:

```bash
brew install git-lfs
afte this clone repo with "git-lfs clone url.."
```

#### Ubuntu/Debian:

```bash
sudo apt update
sudo apt install git-lfs
```

#### Windows:

- Download and install from: https://git-lfs.com/

---

## ğŸ”‘ OpenAI API Key

Set your OpenAI API key in `app.py` (look for `API_KEY = ...`), or modify the code to load from environment variables.

---

## â–¶ï¸ Run the App

Start the FastAPI server locally:

```bash
uvicorn app:app --reload
```

Then go to:
ğŸ‘‰ **http://127.0.0.1:8000/docs** â€“ to try it out via Swagger UI

---

## ğŸ§  How It Works

- Excel sheets are loaded and indexed
- LangChain splits the content and creates embeddings
- FAISS stores the vector data locally
- Queries are semantically matched using GPT and filtered
- Responses are returned as structured JSON

---

## ğŸ§© TODO / Ideas

- âœ… Smart semantic query understanding
- âœ… Vector caching using FAISS
- â³ File upload endpoint
- â³ Basic frontend (streamlit or React)
- â³ Long-term persistent vector DB

---

## ğŸ“ License

This project is intended for internal/demo use. No warranties.
